<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>늘봄 건강 퀴즈</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json" />
  <style>
    .link-copy-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      max-width: 320px;
      height: 60px;
      margin: 24px auto 0 auto;
      background-color: #e0ede3;
      border-radius: 999px;
      color: #356c55;
      font-size: 16px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s ease, box-shadow 0.2s;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .link-copy-btn:hover {
      background-color: #d0e5d6;
      box-shadow: 0 4px 12px rgba(53,108,85,0.08);
    }
    .link-copy-btn img {
      width: 22px;
      height: 22px;
      vertical-align: middle;
    }
    @media (max-width: 480px) {
      .link-copy-btn {
        max-width: 95vw;
        height: 48px;
        font-size: 15px;
      }
      .link-copy-btn img {
        width: 18px;
        height: 18px;
      }
    }
    #copy-msg {
      display:none;
      color:#2e7d32;
      font-weight:bold;
      font-size:1.1em;
      margin-top:10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="assets/img/logo.png" alt="늘봄 로고" class="logo">
    
    <div class="start-screen">
      <h1 class="main-title">나를 위한 작은 습관의 변화, 늘봄</h1>
      <p class="sub-title">오늘도 나를 돌보는 가장 쉬운 방법, 시작해볼까요?</p>

      <div style="text-align:center;">
        <button class="link-copy-btn" onclick="copyLink()">
          <img src="assets/img/link-icon.png" alt="링크 아이콘" />
          같이 하러 가기 💬
        </button>
        <div id="copy-msg">복사되었습니다!</div>
      </div>

      <div class="points-info">
        <p class="current-points">
          💚 현재 나의 습관 포인트: <strong class="point-value" id="points">0</strong>P
        </p>
        
        <div class="points-guide">
          <p class="point-main-text">
            📌 <strong class="point-highlight">5,000포인트</strong>를 달성하면
            <strong>늘봄몰 적립금으로 전환</strong>할 수 있어요!
          </p>
          <p class="point-sub-text">
            환전 신청 버튼은 <strong class="point-emphasis">5,000P 이상</strong>일 때 자동으로 활성화됩니다
          </p>
        </div>

        <div id="points-action">
          <button onclick="location.href='quiz.html'" class="primary-button">
            오늘의 건강 루틴 시작하기 →
          </button>
          <button onclick="requestExchange()" id="exchange-button" class="secondary-button" style="display: none;">
            ✨ 포인트 전환 신청하기
          </button>
          <button onclick="window.open('https://smartstore.naver.com/jinjjamall', '_blank')" class="secondary-button" style="margin-top:10px;">
            🛒 늘봄식품 바로가기
          </button>
          <div id="points-insufficient" class="points-notice" style="display: none;">
            포인트가 부족합니다 😢
          </div>
        </div>
      </div>

      <div class="card-grid">
        <div class="info-card">
          <span class="emoji">✨</span>
          <h3>작은 실천</h3>
          <p>실천할수록 쌓이는 습관 포인트<br>오늘의 나를 위한 작은 투자</p>
        </div>
        <div class="info-card">
          <span class="emoji">🌱</span>
          <h3>건강한 루틴</h3>
          <p>잠깐의 여유, 나를 챙기는 습관<br>하루 한 번쯤, 나를 위한 체크타임!</p>
        </div>
        <div class="info-card">
          <span class="emoji">🎁</span>
          <h3>나를 위한 선물</h3>
          <p>건강 퀴즈로 알아보는 내 몸 사용 설명서<br>알면 지키게 되는 건강 상식!</p>
        </div>
      </div>

      <p class="footer-quote">작은 습관이, 결국 가장 멀리 갑니다</p>
    </div>
  </div>

  <a href="health_quiz_set_all.json" download style="display:block;margin:20px 0;font-size:1.1em;color:#007bff;">문제 전체 JSON 다운로드 (로컬 테스트용)</a>

  <script>
    // 포인트 로드 및 표시
    const points = parseInt(localStorage.getItem('points')) || 0;
    document.getElementById('points').textContent = points;
    
    // 5000포인트 이상이면 전환 버튼 표시
    if (points >= 5000) {
      document.getElementById('exchange-button').style.display = 'block';
    }
    
    // 배경 이미지 랜덤 적용
    const bgList = [
      "assets/img/background/close-up-white-flowering-plant-against-wall.jpg",
      "assets/img/background/still-life-minimalist-lifestyle.jpg",
      "assets/img/background/white-rose-blooming-against-wall.jpg",
      "assets/img/background/view-rose-flowers-condensed-glass.jpg",
      "assets/img/background/modern-minimalist-living-room.jpg"
    ];
    
    const selectedBg = bgList[Math.floor(Math.random() * bgList.length)];
    document.body.style.backgroundImage = `url('${selectedBg}')`;

    function copyLink() {
      navigator.clipboard.writeText(window.location.href)
        .then(() => {
          const msg = document.getElementById('copy-msg');
          msg.style.display = 'block';
          setTimeout(() => { msg.style.display = 'none'; }, 2000);
        })
        .catch(() => alert("복사에 실패했어요 😥"));
    }

    function requestExchange() {
      const confirmMessage = '⚠️ 정말 포인트를 전환하시겠습니까?\n\n확인을 누르시면 현재 보유 중인 모든 포인트가 소멸되며,\n전환 신청 페이지로 이동합니다.\n\n이 작업은 되돌릴 수 없습니다.';
      
      if (window.confirm(confirmMessage)) {
        // 포인트 초기화
        localStorage.setItem('points', '0');
        // 포인트 표시 업데이트
        document.getElementById('points').textContent = '0';
        // 전환 버튼 숨기기
        document.getElementById('exchange-button').style.display = 'none';
        // 구글 폼으로 이동
        setTimeout(() => {
          window.location.href = 'https://docs.google.com/forms/d/e/1FAIpQLSf79U4uayn49L_SMV3KgjnAp8vlP7gx-XJ-v6AnBxveqlIPxg/viewform?usp=header';
        }, 100);
      }
    }
  </script>
  <script src="script.js"></script>
</body>
</html>
