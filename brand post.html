<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ëŠ˜ë´„ ë¸Œëœë“œ ì´ì•¼ê¸° ë“±ë¡</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; }
    label { display: block; margin: 16px 0 6px; font-weight: bold; }
    input, textarea {
      width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px;
      font-size: 16px;
    }
    input[type="datetime-local"] {
      padding: 8px;
    }
    button {
      margin-top: 20px; padding: 12px 20px; font-size: 16px;
      background-color: #356c55; color: white; border: none; border-radius: 8px; cursor: pointer;
    }
    .message { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>ğŸ“¬ ë¸Œëœë“œ ì´ì•¼ê¸° ë“±ë¡</h2>

  <label for="title">ì œëª©</label>
  <input id="title" placeholder="ì˜ˆ: ì˜¤ëŠ˜ë„ ê±´ê°•í•˜ê²Œ ğŸ™‚" />

  <label for="content">ë³¸ë¬¸</label>
  <textarea id="content" rows="6" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”. ì¤„ë°”ê¿ˆë„ ê°€ëŠ¥í•©ë‹ˆë‹¤."></textarea>

  <label for="imageUrl">ì´ë¯¸ì§€ URL</label>
  <input id="imageUrl" placeholder="https://..." />

  <label for="timestamp">ê²Œì‹œì¼ì (ì„ íƒ)</label>
  <input id="timestamp" type="datetime-local" />

  <button onclick="submitPost()">ë“±ë¡</button>

  <div class="message" id="status"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp, Timestamp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDMgQA6mqaXR_qr9Ujy1-VnC-8qkcj3ZBw",
      authDomain: "neulbom-healt-quiz.firebaseapp.com",
      projectId: "neulbom-healt-quiz",
      storageBucket: "neulbom-healt-quiz.firebasestorage.app",
      messagingSenderId: "300280931247",
      appId: "1:300280931247:web:5516f3bd8e8834304a055a"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    window.submitPost = async function () {
      const title = document.getElementById("title").value.trim();
      const content = document.getElementById("content").value.trim();
      const imageUrl = document.getElementById("imageUrl").value.trim() || null;
      const timestampInput = document.getElementById("timestamp").value;
      const status = document.getElementById("status");

      if (!title || !content) {
        status.textContent = "â— ì œëª©ê³¼ ë³¸ë¬¸ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.";
        status.style.color = "red";
        return;
      }

      let timestampValue;
      if (timestampInput) {
        const date = new Date(timestampInput);
        timestampValue = Timestamp.fromDate(date);
      } else {
        timestampValue = serverTimestamp();
      }

      try {
        await addDoc(collection(db, "brand_posts"), {
          title,
          content,
          imageUrl,
          author: "ëŠ˜ë´„ì‹í’ˆ",
          commentCount: 0,
          likes: 0,
          isPublished: true,
          timestamp: timestampValue
        });

        status.textContent = "âœ… ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!";
        status.style.color = "green";
        document.getElementById("title").value = "";
        document.getElementById("content").value = "";
        document.getElementById("imageUrl").value = "";
        document.getElementById("timestamp").value = "";
      } catch (err) {
        status.textContent = "âš ï¸ ì˜¤ë¥˜ ë°œìƒ: " + err.message;
        status.style.color = "red";
      }
    };
  </script>
</body>
</html>
